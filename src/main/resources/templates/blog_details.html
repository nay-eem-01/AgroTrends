<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="en" class="dark">
<head>
    <title th:text="${blog.title} + ' - AgroTrends'">Blog Details - AgroTrends</title>
    <th:block th:replace="~{fragments/layout :: head}"></th:block>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 font-sans antialiased">
<!-- Header -->
<th:block th:replace="~{fragments/layout :: header}"></th:block>

<!-- Blog Details Section -->
<section class="container mx-auto px-4 py-16 animate-fade-in">
    <article class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8 max-w-3xl mx-auto">
        <h1 th:text="${blog.title}"
            class="text-3xl md:text-4xl font-extrabold text-green-800 dark:text-green-300 mb-4"></h1>
        <div class="flex items-center text-sm text-gray-500 dark:text-gray-400 mb-6">
            <span>By <span th:text="${blog.author.userName}">Author</span></span>
            <span class="mx-2">â€¢</span>
            <span th:text="${#temporals.format(blog.createdAt, 'MMM dd, yyyy')}">Date</span>
        </div>
        <img th:if="${blog.imageUrl}"
             th:src="${blog.imageUrl}"
             alt="Blog Image"
             class="w-full h-64 object-cover rounded-lg mb-6"
             onerror="this.src='https://source.unsplash.com/800x400/?agriculture'">
        <img th:unless="${blog.imageUrl}"
             src="https://source.unsplash.com/800x400/?agriculture"
             alt="Blog Image"
             class="w-full h-64 object-cover rounded-lg mb-6">
        <div th:utext="${blog.content}"
             class="prose prose-green dark:prose-invert max-w-none text-gray-700 dark:text-gray-200 mb-8"></div>
    </article>

    <!-- Comments Section -->
    <section class="max-w-3xl mx-auto mt-12">
        <h2 class="text-2xl font-semibold text-gray-800 dark:text-gray-100 mb-6">Comments</h2>
        <div th:each="comment : ${blog.comments}"
             class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-4 animate-slide-up">
            <div class="flex items-center mb-2">
                    <span th:text="${comment.userId}"
                          class="font-medium text-green-800 dark:text-green-300"></span>
                <span class="ml-2 text-sm text-gray-500 dark:text-gray-400"
                      th:text="${#temporals.format(comment.createdAt, 'MMM dd, yyyy HH:mm')}">Date</span>
            </div>
            <p th:text="${comment.commentContent}"
               class="text-gray-700 dark:text-gray-200"></p>
        </div>
        <div th:unless="${blog.comments} and ${#lists.size(blog.comments) > 0}"
             class="text-gray-500 dark:text-gray-400 mb-6">
            No comments yet. Be the first to comment!
        </div>

        <!-- Comment Form -->
        <div sec:authorize="isAuthenticated()" class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 animate-slide-up">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Add a Comment</h3>
            <form th:action="@{/app/blog/{id}/comment(id=${blog.blogId})}" method="post" class="space-y-4">
                    <textarea name="content"
                              required
                              placeholder="Write your comment here..."
                              class="w-full px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition"
                              rows="4"></textarea>
                <button type="submit"
                        class="px-6 py-2 bg-primary text-white rounded-lg font-medium hover:bg-secondary transition">
                    Post Comment
                </button>
            </form>
        </div>
        <div sec:authorize="isAnonymous()" class="text-gray-500 dark:text-gray-400">
            Please <a href="/app/api/auth/signin" class="text-primary dark:text-green-400 hover:underline">sign in</a> to add a comment.
        </div>
    </section>
</section>

<!-- Footer -->
<th:block th:replace="~{fragments/layout :: footer}"></th:block>

<!-- Scripts -->
<th:block th:replace="~{fragments/layout :: scripts}"></th:block>
</body>
</html>
```